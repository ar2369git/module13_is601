<!DOCTYPE html>
<html>
<head><meta charset="utf-8"/><title>Login</title></head>
<body>
  <h1>Login</h1>
  <form id="login-form">
    <input id="email" type="email" placeholder="Email or Username" required /><br/>
    <input id="password" type="password" placeholder="Password" required /><br/>
    <button type="submit">Login</button>
  </form>
  <div id="msg"></div>
  <script>
    document.getElementById("login-form").addEventListener("submit", async e => {
      e.preventDefault();
      const u = e.target.email.value, pw = e.target.password.value;
      const resp = await fetch("/login", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body: JSON.stringify({username_or_email:u,password:pw})
      });
      const j = await resp.json();
      if (resp.ok) {
        localStorage.setItem("token", j.access_token);
        document.getElementById("msg").innerText = "Logged in!";
      } else {
        document.getElementById("msg").innerText = j.detail || j.error;
      }
    });
  </script>
</body>
</html>

